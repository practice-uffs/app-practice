<template>
	<div data-name="aura" id="tab_aura" style="height: 100%;">
		{{#if passport}}
			<iframe id="aura_iframe" style="width: 100%;height: 100%;" src="{{url}}widgets/aura?token={{passport}}&type=fullscreen" frameborder="0" ></iframe>
		{{else}}
			<iframe id="aura_iframe" style="width: 100%;height: 100%;" src="{{url}}widgets/aura?type=fullscreen" frameborder="0" ></iframe>
		{{/if}}
	</div>
</template>

<style>
	.preloader-modal {
		background-color: transparent;
	}
</style>

<script>
	import 'dom7/dist/dom7.js';

	export default {
		data: function () {
			return {
				passport: null,
				url: null,
			}
		},
		on: {
			tabInit: function (e, page) {
				
				let self = this;
				let app = self.$app;
				app.preloader.show('blue');
				
				let url = app.api.url;
				let userCredentials = app.storage.getUserCredentials()
				
				self.$setState({
					passport: userCredentials.passport,
					url: url
				});
				app.$$("#aura_iframe").on('load', function(e) {
					app.preloader.hide();
				})
			},
		}
	};
</script>